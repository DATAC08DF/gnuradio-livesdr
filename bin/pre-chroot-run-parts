#!/bin/sh
set -o nounset
#set -x #DEBUG

. bin/library.sh

# Exit if already run
[ ! -f stamps/pre-chroot.stamp ] || exit 0

# Execute each fragment in config/pre-chroot.d
printinfo Executing pre-chroot customization scripts...
require_rootfs_rw_mounted

run-parts \
    --exit-on-err \
    config/pre-chroot.d || die One or more pre-chroot scripts failed!

printinfo Pre-chroot customization scripts completed.
